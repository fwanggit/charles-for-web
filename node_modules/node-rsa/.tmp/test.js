var NodeRSA = require('../src/NodeRSA');
var key = new NodeRSA(/*{b: 512}*/);
/*
var a = key.exportKey('components');
a.n = a.n.toString('hex');
a.d = a.d.toString('hex');
a.p = a.p.toString('hex');
a.q = a.q.toString('hex');
a.dmp1 = a.dmp1.toString('hex');
a.dmq1 = a.dmq1.toString('hex');
a.coeff = a.coeff.toString('hex');

console.log(a)*/

key.importKey({
    n: new Buffer('0086fa9ba066685845fc03833a9699c8baefb53cfbf19052a7f10f1eaa30488cec1ceb752bdff2df9fad6c64b3498956e7dbab4035b4823c99a44cc57088a23783', 'hex'),
    e: 65537,
    d: new Buffer('5d2f0dd982596ef781affb1cab73a77c46985c6da2aafc252cea3f4546e80f40c0e247d7d9467750ea1321cc5aa638871b3ed96d19dcc124916b0bcb296f35e1', 'hex'),
    p: new Buffer('00c59419db615e56b9805cc45673a32d278917534804171edcf925ab1df203927f', 'hex'),
    q: new Buffer('00aee3f86b66087abc069b8b1736e38ad6af624f7ea80e70b95f4ff2bf77cd90fd', 'hex'),
    dmp1: new Buffer('008112f5a969fcb56f4e3a4c51a60dcdebec157ee4a7376b843487b53844e8ac85', 'hex'),
    dmq1: new Buffer('1a7370470e0f8a4095df40922a430fe498720e03e1f70d257c3ce34202249d21', 'hex'),
    coeff: new Buffer('00b399675e5e81506b729a777cc03026f0b2119853dfc5eb124610c0ab82999e45', 'hex')
}, 'components');
var publicComponents = key.exportKey('components-public');
console.log(publicComponents)

/*var key2 = new NodeRSA();


var modulus = new Buffer('00b04d5e7727d3a1946fe9c14e901d2d009e6a268af8605e4271c2402f47d2fe8d58935d154971f85f1e297922606102a43b41ea3b5840cfa93d745401e14d429d6b518ed3447087f272aad9ae1bbaca8bb9b326fa49c57766effd6e6eff0f268b971fe026150f4753b13b36aab04be5bbb85b0e134b218a35cca15bfda5016c3ebe51c686c47d817c535dcd502d55256973fb36637b1ba0c37bac1c948fbf77ee242568c20dbd58f26acca762ecc7370e9944ff493fd7f0c6b0b26b19d33d6c55974aaf55a40edbe4ed14cb435c7d8e559b5659e2c700bf1c8a5770d06faedaa56a4ea206130372265b001f291a3c500c5b4c4bb9eba6ad2941f895093eb46fbf0e2704277818eacd4a53c213fc6593509bf096880932ef0d471873766a2f78ea02e781864a70dae0b3f3154978e035298e24408231f09101b006338323f68b2d', 'hex');
var exp = new Buffer(4);
exp.writeInt32BE(65537, 0);

key2.importKey({
    n: modulus,
    d: new Buffer('2305cb9d4a191d811a564a636bf78fc80eb031a5ebbf611a3bf505c11eb8887ed5b8b886110805fa0748dfda7760ee2067f12931cecf59315a96f0554b4788d332cd89dce83c9e9508386e73cae86972265ab3848701263e19b0b3ae7316b4668887f984372cc8d3946299f28081234b0e4d70575ed673d94a2447dcf4597b025fd668e4bec5dbe231c17196dada8e4b0b923cf4b830fdd7b78ab246c4e399542df1aa788d2460369d5a9f3ca70ea29172659f6a776353cd405ddecb670df929f37748f1fdce5f0fd075cf1298bf96d4a3e5274f307157cd5ef710897e4757bfee83e6a0e7d6018b75965ae45c6d65b460561fd996a3fdc58afbd9ab3f585988036d304601cf816bcbc87b21d174e1a997f6fcedd1f0a985bfc693fa499ce62b3ab1522d2088bb96da2b55aa539096a2df3cff55230105a2fecad14df63565e1', 'hex'),
    e: 65537
}, 'components-public');

var text = 'Hello RSA!';




var privateKeyPKCS1 = '-----BEGIN RSA PRIVATE KEY-----\n' +
    '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\n' +
    '-----END RSA PRIVATE KEY-----';

key.importKey(privateKeyPKCS1);

var a = key.exportKey('components');
a.n = a.n.toString('base64');
a.d = a.d.toString('base64');
a.p = a.p.toString('base64');
a.q = a.q.toString('base64');
a.dmp1 = a.dmp1.toString('base64');
a.dmq1 = a.dmq1.toString('base64');
a.coeff = a.coeff.toString('base64');

var b = key.exportKey('components-public');
b.n = b.n.toString('base64');
console.log(a);
console.log(b);


var s = key.sign(text);

console.log(key2.verify(text, s));*/